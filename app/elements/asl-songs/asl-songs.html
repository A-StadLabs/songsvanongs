<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/firebase-element/firebase-element.html">
<link rel="import" href="../../bower_components/core-selector/core-selector.html">
<link rel="import" href="../../elements/our-playitem/our-playitem.html">
<polymer-element name="asl-songs" attributes="">
  <template>
    <firebase-element id="base" on-data-change="{{handleResponse}}" keys="{{keys}}" data="{{data}}" location="https://songsvanongs.firebaseio.com/songs" log></firebase-element>
    <link rel="stylesheet" href="asl-songs.css">
    <core-selector valueattr="song" id="songselector">
    <template repeat="{{s in songs}}">
      <our-playitem song="{{s}}" active?="{{selected}}"></our-playitem>
    </template>
    </core-selector>
  </template>
  <script>
    (function () {
      'use strict';

      Polymer({
        // define element prototype here

        ready: function(){
          //console.log('songs: ',this.songs);
          this.$.songselector.addEventListener('core-select', function(){
            //console.log('song selected', this.selected);
            this.fire('setSong', { msg: this.selected });
          });
        },

        shuffle: function(){
          console.log('shffling');
          this.songs.reverse();
        },

        nextSong: function(){
          this.$.songselector.selected++;
        },

        handleResponse: function(e){
          this.songs = [];
          console.log('got data');
          console.log('got data:', this.keys);
          for (var i = 0; i <= this.keys.length; i++) {
            //console.log(this.keys[i]);
            var j = this.keys[i];
            if(this.data[j].songtitle!=''){
              this.songs.push(this.data[j]);
            }
          };
        }

      });

    })();
  </script>
</polymer-element>
